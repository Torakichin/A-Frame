<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <script src="https://aframe.io/releases/1.1.0/aframe.min.js"></script>

    <script>
      // 凝視テレポートのカスタムコンポーネントを定義
      AFRAME.registerComponent('gaze-teleport', {
        init: function () {
          var el = this.el; // このコンポーネントがアタッチされるカーソル要素 (a-cursor)
          // カメラリグの要素を取得。シンプルにするため、ここではカメラ自体を動かします。
          // もしカメラリグを明示的に定義するなら、そのIDをここに指定してください。
          var cameraEl = document.querySelector('[camera]'); 

          // カーソルからの'click'イベントをリッスン
          el.addEventListener('click', function (evt) {
            var intersection = evt.detail.intersection; // 視線が当たった点の情報
            if (!intersection) { return; } 

            // 視線が当たったオブジェクトが 'teleportable' クラスを持っているか確認
            if (intersection.object.el && intersection.object.el.classList.contains('teleportable')) {
              var newPosition = intersection.point; // 当たった点の3D座標を取得
              
              // カメラを新しい位置に移動させる
              // Y座標は地面に埋もれないよう、一般的な目の高さ（1.6メートル）に設定
              cameraEl.setAttribute('position', {
                x: newPosition.x,
                y: 1.6, 
                z: newPosition.z
              });
            }
          });
        }
      });
    </script>

  </head>
  <body>
    <a-scene>
      <a-plane class="teleportable" position="0 0 -4" rotation="-90 0 0" width="100" height="100" color="#7BC8A4"></a-plane>
      
      <a-sky color="#ECECEC"></a-sky>

      <a-entity camera position="0 1.6 0" wasd-controls look-controls>
        <a-cursor fuse="true" timeout="1500" color="#FF0000" scale="0.1 0.1 0.1" 
                  raycaster="far: 100;"></a-cursor>
      </a-entity>
    </a-scene>
  </body>
</html>
