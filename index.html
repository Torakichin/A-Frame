<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>AR 3Dモデル 回転 (タップで)</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
  </head>
  <body style="margin: 0; overflow: hidden">
    <a-scene embedded arjs vr-mode-ui="enabled: false">
      <a-assets>
        <a-asset-item id="chaei" src="Wood_Table.glb" scale="1 1 1"></a-asset-item>
      </a-assets>
      <a-marker type="pattern" url="pattern-marker.patt">
        <a-entity
          id="rotatableModel"
          gltf-model="#chaei"
          rotation="-90 0 0"
        ></a-entity>
      </a-marker>
      <a-entity camera></a-entity>
    </a-scene>
  </body>
  <script>
    // glTFの表示が暗くなる問題に対処 (現代的な設定)
    // Three.jsのレンダラーが初期化された後に設定する必要があります
    document.querySelector("a-scene").addEventListener('loaded', function () {
        this.renderer.outputEncoding = THREE.sRGBEncoding;
        this.renderer.physicallyCorrectLights = true;
    });

    // 3Dモデルの回転を制御するJavaScript
    document.addEventListener('DOMContentLoaded', function () {
        const rotatableModel = document.querySelector('#rotatableModel');
        let currentYRotation = 0; // 現在のY軸回転角度を保持 (0から360の範囲で管理)

        // モデルがタップ/クリックされたときのイベントリスナー
        rotatableModel.addEventListener('click', function () {
            // 現在のY軸の回転角度を90度加算
            currentYRotation += 90;
            // 360度を超えたら0に戻す (任意)
            if (currentYRotation >= 360) {
                currentYRotation = 0;
            }

            // A-Frameのrotation属性を更新
            // X軸は-90度固定、Y軸は現在の回転値、Z軸は0
            // transitionDurationはアニメーションの時間を設定できます
            rotatableModel.setAttribute('rotation', `-90 ${currentYRotation} 0`);
        });
    });
  </script>
</html>
